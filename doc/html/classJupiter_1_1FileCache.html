<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>filecache: Jupiter::FileCache Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><b>Jupiter</b>::<a class="el" href="classJupiter_1_1FileCache.html">FileCache</a>
  </div>
</div>
<div class="contents">
<h1>Jupiter::FileCache Class Reference</h1><!-- doxytag: class="Jupiter::FileCache" -->
<p>Multi location, multi process, thread safe file cache class.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="filecache_8hpp_source.html">filecache.hpp</a>&gt;</code></p>

<p><a href="classJupiter_1_1FileCache-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJupiter_1_1FileCache_a1a7c20171d8a1810177a8f7f601d22d4.html#a1a7c20171d8a1810177a8f7f601d22d4">FileCache</a> (bool activate=true)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a new cache instance.  <a href="#a1a7c20171d8a1810177a8f7f601d22d4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afdb5f0cc1ffc3dd169cee9d20a39ca17"></a><!-- doxytag: member="Jupiter::FileCache::FileCache" ref="afdb5f0cc1ffc3dd169cee9d20a39ca17" args="(const fs::path &amp;where, bool activate=true)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>FileCache</b> (const fs::path &amp;where, bool activate=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaaed0982b4b09e86ce6328a9bebfdd1f"></a><!-- doxytag: member="Jupiter::FileCache::FileCache" ref="aaaed0982b4b09e86ce6328a9bebfdd1f" args="(const std::string &amp;where, bool activate=true)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>FileCache</b> (const std::string &amp;where, bool activate=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJupiter_1_1FileCache_ad73841ddc177fdb52da0231ac7847a06.html#ad73841ddc177fdb52da0231ac7847a06">FileCache</a> (const <a class="el" href="classJupiter_1_1FileCache.html">FileCache</a> &amp;fc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy constructor.  <a href="#ad73841ddc177fdb52da0231ac7847a06"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classJupiter_1_1FileCache.html">FileCache</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJupiter_1_1FileCache_ae505be275ce001eb3125cf2f02ee687e.html#ae505be275ce001eb3125cf2f02ee687e">operator=</a> (const <a class="el" href="classJupiter_1_1FileCache.html">FileCache</a> &amp;fc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Assignment operator.  <a href="#ae505be275ce001eb3125cf2f02ee687e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7ec40d5754b87fb0b3fdb73c109b9751"></a><!-- doxytag: member="Jupiter::FileCache::operator==" ref="a7ec40d5754b87fb0b3fdb73c109b9751" args="(const FileCache &amp;fc) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>operator==</b> (const <a class="el" href="classJupiter_1_1FileCache.html">FileCache</a> &amp;fc) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJupiter_1_1FileCache_aaa837872436dd14f37a0c7bb414ff059.html#aaa837872436dd14f37a0c7bb414ff059">~FileCache</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor.  <a href="#aaa837872436dd14f37a0c7bb414ff059"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fs::path&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJupiter_1_1FileCache_a1802eb61f20456a13108a7430e0182c9.html#a1802eb61f20456a13108a7430e0182c9">cacheFile</a> (const fs::path &amp;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Cache a file.  <a href="#a1802eb61f20456a13108a7430e0182c9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab82776dfea632ecd0dca67bbc71413ec"></a><!-- doxytag: member="Jupiter::FileCache::cacheFile" ref="ab82776dfea632ecd0dca67bbc71413ec" args="(const std::string &amp;toCache)" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><b>cacheFile</b> (const std::string &amp;toCache)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fs::path&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJupiter_1_1FileCache_ad63acda12fba3628b73cc62052ed5f18.html#ad63acda12fba3628b73cc62052ed5f18">uncacheFile</a> (const fs::path &amp;fromCache, bool overwrite=true, bool ifNewer=true)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy a file back from the cache.  <a href="#ad63acda12fba3628b73cc62052ed5f18"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a17c82e1cbfb9bac9ddbd753027451c4f"></a><!-- doxytag: member="Jupiter::FileCache::uncacheFile" ref="a17c82e1cbfb9bac9ddbd753027451c4f" args="(const std::string &amp;fromCache, bool overwrite=true, bool ifNewer=true)" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><b>uncacheFile</b> (const std::string &amp;fromCache, bool overwrite=true, bool ifNewer=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fs::path&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJupiter_1_1FileCache_a19c5dd2cc00ee747696d8a33817ef875.html#a19c5dd2cc00ee747696d8a33817ef875">cacheFileForWriting</a> (const fs::path &amp;toCache)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct a cache path for writing.  <a href="#a19c5dd2cc00ee747696d8a33817ef875"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a94bc3b04b2b134ca46999a5deb093bdc"></a><!-- doxytag: member="Jupiter::FileCache::cacheFileForWriting" ref="a94bc3b04b2b134ca46999a5deb093bdc" args="(const std::string &amp;toCache)" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><b>cacheFileForWriting</b> (const std::string &amp;toCache)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJupiter_1_1FileCache_a248a464453ce8e63c7ffbf33f04455b8.html#a248a464453ce8e63c7ffbf33f04455b8">releaseFile</a> (const fs::path &amp;path)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Releases a file from the cache for the current process.  <a href="#a248a464453ce8e63c7ffbf33f04455b8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a03195fdcc141c652a9c70eda496f0296"></a><!-- doxytag: member="Jupiter::FileCache::releaseFile" ref="a03195fdcc141c652a9c70eda496f0296" args="(const std::string &amp;path)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>releaseFile</b> (const std::string &amp;path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJupiter_1_1FileCache_ac8c4eda4bcc68beff3bcd81da1ba5235.html#ac8c4eda4bcc68beff3bcd81da1ba5235">babble</a> (bool logging)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Toggle verbosity messages for this cache instance on/off.  <a href="#ac8c4eda4bcc68beff3bcd81da1ba5235"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad90edfa82b5c38337212fd61ad6dc405"></a><!-- doxytag: member="Jupiter::FileCache::relocate" ref="ad90edfa82b5c38337212fd61ad6dc405" args="(const fs::path &amp;where)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>relocate</b> (const fs::path &amp;where)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acafbeec2ee4679969bca8e3c6a34cf28"></a><!-- doxytag: member="Jupiter::FileCache::relocate" ref="acafbeec2ee4679969bca8e3c6a34cf28" args="(const std::string &amp;where)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>relocate</b> (const std::string &amp;where)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJupiter_1_1FileCache_a2abeec329b1cb028682e802368266be1.html#a2abeec329b1cb028682e802368266be1">resize</a> (uintmax_t size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the cache's new size in Megabytes for this cache's location.  <a href="#a2abeec329b1cb028682e802368266be1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uintmax_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJupiter_1_1FileCache_a2cfadce04d35ef70a329f2981eec65e2.html#a2cfadce04d35ef70a329f2981eec65e2">size</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Query the cache's size.  <a href="#a2cfadce04d35ef70a329f2981eec65e2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJupiter_1_1FileCache_a1bb18d23ad40116e79caea006dea0802.html#a1bb18d23ad40116e79caea006dea0802">operator fs::path</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert the cache's location to a boost::filesystem::path.  <a href="#a1bb18d23ad40116e79caea006dea0802"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJupiter_1_1FileCache_a28fecb5ef8dfa2cc7d613fa50ee37d4e.html#a28fecb5ef8dfa2cc7d613fa50ee37d4e">operator std::string</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert the cache's location to a std::string.  <a href="#a28fecb5ef8dfa2cc7d613fa50ee37d4e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJupiter_1_1FileCache_ae1fad18f9dffc5f444a4418e45ab45f5.html#ae1fad18f9dffc5f444a4418e45ab45f5">location</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Query the cache's location.  <a href="#ae1fad18f9dffc5f444a4418e45ab45f5"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Multi location, multi process, thread safe file cache class. </p>
<p>Manages local caches that mirror files in remote locations.</p>
<dl class="user"><dt><b>Precautions</b></dt><dd>The following precautions are taken to ensure the proper operation of the cache:<ol type="1">
<li>When used as a read cache, the filecache lib does not access the original file in any dangerous way, only reading is performed on those files.</li>
<li>The cache is kept synchronized with the files it mirrors: if an original file is newer than the cached one (or has a different size), the cache is updated; unless the file is being used by another cache instance on the same machine.</li>
<li>A file is identified by its full path: files that have the same name in different directories do not collide.</li>
<li>Symbolic links are resolved prior to caching, this ensures that a given file is cached only once even if many links point to it.</li>
<li>The filecache is multi-process- and -thread safe. Even if many processe are running on the same machine, sharing a cache, the cache is kept in a consistent state: one filecache instance does not remove or update a file used by another instance in a different process and/or thread!</li>
<li>When the cache is used as a write cache, only one instance can use a particular write location in a cache.</li>
<li>When copying write-cached files back, the cache can check if the file already exists at the destination and/or has a newer date. By default, existing files are only overwritten if they are older than the write- cached file.</li>
<li>If, for any reason, the filecache lib is unable to cache a file, it reverts to use the original, and this is the worst case scenario.</li>
</ol>
</dd></dl>
<dl class="user"><dt><b>Thread safety</b></dt><dd>The cache always does obtain a mutex lock before accessing or modifying any data. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>Cache locations are referenced per class instance. This ensures that there can be more that one cache instance per location per process. The destructor of any instance of a cache in any thread of the same process at the same cache location will release the files of that cache location for this instance only. Other instances of the cache with this location under the same process will keep shared files locked throughout their lifetime. </dd></dl>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/<a class="el" href="filecache_8hpp_source.html">filecache.hpp</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
